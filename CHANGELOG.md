# سجل التغييرات - WhatsApp Proxy Server

## [2.0.0] - 2025-01-27

### ✨ ميزات جديدة
- **تحديث API:** استبدال API القديم بـ API جديد يعمل على خادم AWS
- **راوت جديد:** إضافة `/api-status` للتحقق من حالة API الجديد
- **ملف تكوين:** إضافة `config.js` لإدارة الإعدادات
- **معالجة محسنة للأخطاء:** تنسيق موحد لجميع الاستجابات

### 🔄 تغييرات رئيسية
- **Endpoint:** من `http://wa.elliaa.com/send-message` إلى `http://13.51.195.216:3000/api/send-message`
- **المعاملات:** تغيير `number` إلى `phone` في API الجديد
- **تنسيق الاستجابة:** تحديث ليتوافق مع API الجديد
- **معالجة الأخطاء:** تحسين معالجة الأخطاء والاستجابات

### 📝 تفاصيل التحديثات

#### 1. تحديث Endpoint
```javascript
// القديم
'http://wa.elliaa.com/send-message'

// الجديد
'http://13.51.195.216:3000/api/send-message'
```

#### 2. تحديث المعاملات
```javascript
// القديم
{
  number: "201234567890",
  message: "مرحباً"
}

// الجديد (يتم التحويل تلقائياً)
{
  phone: "201234567890",  // تم تحويله من 'number'
  message: "مرحباً"
}
```

#### 3. تحديث الاستجابات
```javascript
// الاستجابة الناجحة
{
  "success": true,
  "messageId": "3EB0C767D8B7A8F9",
  "timestamp": "2025-08-12T15:30:00.000Z",
  "phone": "201234567890@c.us"
}

// الاستجابة الفاشلة
{
  "success": false,
  "error": "Failed to send message",
  "message": "Error details"
}
```

### 🛠️ تحسينات تقنية
- **إدارة التكوين:** فصل الإعدادات في ملف `config.js`
- **معالجة الأخطاء:** تحسين معالجة أخطاء الشبكة والاتصال
- **التسجيل:** تحسين رسائل التسجيل مع معلومات التحديث
- **CORS:** إعدادات CORS قابلة للتكوين

### 📁 ملفات جديدة
- `config.js` - ملف التكوين الرئيسي
- `test_new_api.js` - ملف اختبار API الجديد
- `README.md` - وثائق محدثة
- `CHANGELOG.md` - سجل التغييرات

### 🔧 ملفات محدثة
- `proxy_server.js` - التحديث الرئيسي للكود
- `package.json` - إضافة سكريبت الاختبار

### 🧪 اختبارات
- اختبار حالة API الجديد
- اختبار البروكسي مع API الجديد
- اختبار صحة الخادم
- اختبار الراوت الجديد

### 📋 متطلبات النظام
- Node.js >= 14.0.0
- npm أو yarn
- اتصال بالإنترنت للوصول إلى API الجديد

### 🚀 كيفية التحديث
1. إيقاف الخادم الحالي
2. نسخ الملفات الجديدة
3. تشغيل `npm install` (إذا لزم الأمر)
4. تشغيل `npm start`
5. اختبار الوظائف الجديدة

### ⚠️ ملاحظات مهمة
- **توافق عكسي:** API القديم لم يعد مدعوماً
- **المعاملات:** يجب استخدام `number` في الطلبات (سيتم التحويل تلقائياً)
- **Timeout:** 30 ثانية للطلبات
- **CORS:** مفعل لجميع النطاقات

### 🐛 إصلاحات
- إصلاح معالجة الأخطاء في API القديم
- تحسين رسائل الخطأ
- إصلاح مشاكل CORS

### 📚 وثائق
- تحديث README.md مع معلومات API الجديد
- إضافة أمثلة للاستخدام
- توثيق التغييرات والتحديثات

---

## [1.0.0] - 2024-01-01

### ✨ الإصدار الأول
- خادم بروكسي أساسي لـ WhatsApp API
- دعم HTTP و HTTPS
- معالجة أساسية للأخطاء
- دعم CORS 